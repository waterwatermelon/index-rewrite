<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .box {
            width: 200px;
            height: 24px;
            overflow: hidden;
            border: 1px solid grey;
        }

        .digital-col {
            position: relative;
            float: left;
            width: 14px;
            text-align: center;
            line-height: 24px;
        }

        .digital-col span {
            border-right: 1px solid slateblue;
        }
    </style>
</head>

<body>
    <div class="box">
        <div class="digital-col">
        </div>
    </div>
</body>
<script>
    function init(box, n) {
        console.log('init ');
        console.log(`n = ${n}`);
        var col;
        for (var i = 0; i < n; i++) {

            addCol(box);
            col = box.getElementsByClassName('digital-col')[0];
            refresh(col, 0);
        }
    }
    function addCol(box) {
        var str = `<div class="digital-col"></div>`;
        box.innerHTML = str + box.innerHTML;
    }
    function refresh(col, nowValue = 0) {
        var nowValue, nextValue;
        nowValue = nowValue;
        nextValue = (nowValue + 1) % 10;
        console.log(`init(${nowValue},${nextValue})`);
        var nowNode, nextNode;
        nowNode = `<span>${nowValue}</span>`;
        newxtNode = `<span>${nextValue}</span>`;
        col.innerHTML = nowNode + '<br>' + newxtNode;
    }
    function scroll(col, start, end) {
        var top = 0,//盒子的top
            height = 24;//数字的高度
        var nowValue; //当前值，要被往上滚
        nowValue = start;
        var timer;
        refresh(col, start);
        timer = setInterval(function () {
            col.style.top = (-1) * (++top) + 'px';
            if (top == height) {
                console.log('top == height ');
                top = 0;
                col.style.top = 0;
                nowValue = (nowValue + 1) % 10;
                //TODO:如果当前值为0，需要做进位处理
                if (nowValue == 0) {
                    scroll();
                }
                refresh(col, nowValue);
                console.log(`nowValue = ${nowValue}`);
                console.log(`end = ${end}`);
                if (nowValue == end) {
                    clearInterval(timer);
                }
            }
        }, 40);//滚动周期控制
    }
    // scroll(8,1);
    function carry() {
        var box = document.getElementsByClassName('box')[0];
        var digitalCol;
        addCol(box);
        digitalCol = document.getElementsByClassName('digital-col')[0];
    }
    /*将数字拆开,转成数字 数组*/
    function numToArray(num) {
        if (typeof num !== "number") {
            console.log('传入不合法数字 @numToArray()');
        }
        var str = num.toString();
        var arr;
        arr = str.split('').map(Number);
        return arr;
    }
    function main(nowNum, nextNum) {
        var box = document.getElementsByClassName('box')[0];
        var col;
        var nowArr, nextArr;
        nowArr = numToArray(nowNum);
        nextArr = numToArray(nextNum);

        init(box, nowArr.length);
        // for (var i = nextArr.length - 1; i >= 0; i--) 
        // {
            var i = nextArr.length - 1;
            col = document.getElementsByClassName('digital-col')[i];
            scroll(col, nowArr[i], nextArr[i]);
        // }
    }
    main(8,3);
</script>

</html>